<!doctype html>
<html>

<head>
    <title>yLawn</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1, user-scalable=0" />
    <meta charset="utf-8">
    <link href="../css/style.css" rel="stylesheet">
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/default.css" rel="stylesheet">
    <link href="../css/default.date.css" rel="stylesheet">
    <script src="../js/josephine-slab.js"></script>
    <script src="http://code.jquery.com/jquery.js"></script>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <script src="../js/bootstrap.js"></script>
    <script src="../libs/picker.js"></script>
    <script src="../libs/picker.date.js"></script>
    <script src="http://www.parsecdn.com/js/parse-1.2.13.min.js"></script>
    <script src="../js/app.js"></script>
    <script src="js/push.js"></script>
</head>

<body>
    <div class="body-wrap">
        <div class="navbar navbar-fixed-top">
            <div class="container">
                <span class="navbar-brand">
                    <i class="fa fa-chevron-left" onclick="history.back(-1)"></i>&nbsp;&nbsp;Details</span>
            </div>
        </div>
        <div class="section">
            <div class="container">
                <div class="details-banner lawn-bg1">
                    <span class="lawnid">Upper Lawn</span>
                </div>
                <div class="content-card">
                    <div class="card-wrapper">
                        <div class="card-type mow-title">Mow</div>
                        <div class="card-type-sub">As needed - weekly in the summer</div>
                        <div class="horiz-line"></div>
                        <div class="card-data-row">
                            <div class="data-date" id="mow-date-field1">
                            </div>
                            <div class="data-date" id="mow-direction1">
                            </div>
                        </div>
                        <div class="card-data-row">
                            <div class="data-label">
                                Last Mowed
                            </div>
                            <div class="data-label">
                                Direction
                            </div>
                        </div>
                        <div class="horiz-line"></div>
                        <div class="mow-action" id="mow-action">
                            <i class="fa fa-sign-in"></i>&nbsp;&nbsp;Update</div>
                        <form role="form" id="mow-form">
                            <div class="form-update" id="mow-update">
                                <div class="horiz-form">
                                    <label for="new-mow-date">Date:</label>
                                    <input type="text" class="datepicker" id="new-mow-date" name="new-mow-date">
                                </div>
                                <div class="horiz-form">
                                    <label>Direction:</label>
                                    <select id="new-mow-direction" name="new-mow-direction">
                                        <option value="" selected style="display:none;">Select...</option>
                                        <option value="NS">North-South</option>
                                        <option value="EW">East-West</option>
                                    </select>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" id="cancel-mow-update">Cancel</button>
                                    <button type="button" class="btn btn-lawn" id="save-mow-update">Save changes</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="content-card">
                    <div class="card-wrapper">
                        <div class="card-type water-title">Water</div>
                        <div class="card-type-sub">1 inch per week in late summer</div>
                        <div class="horiz-line"></div>
                        <div class="card-data-row">
                            <div class="data-date" id="water-date-field1">
                            </div>
                        </div>
                        <div class="card-data-row">
                            <div class="data-label">
                                Last Watered
                            </div>
                        </div>
                        <div class="horiz-line"></div>
                        <div class="mow-action" id="water-action">
                            <i class="fa fa-sign-in"></i>&nbsp;&nbsp;Update</div>
                        <form role="form" id="water-form">
                            <div class="form-update" id="water-update">
                                <div class="horiz-form">
                                    <label>Date:</label>
                                    <input type="text" class="datepicker" id="waterLabel">
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" id="cancel-water-update">Cancel</button>
                                    <button type="button" class="btn btn-lawn" id="save-water-update">Save changes</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="content-card">
                    <div class="card-wrapper">
                        <div class="card-type fert-title">Fertilizer</div>
                        <div class="card-type-sub">Seasonally - 4 times per year</div>
                        <div class="horiz-line"></div>
                        <div class="card-data-row">
                            <div class="data-date" id="fert-date-field1">
                            </div>
                            <div class="data-types" id="fert-type1">
                            </div>
                        </div>
                        <div class="card-data-row">
                            <div class="data-label">
                                Last Fertilized
                            </div>
                            <div class="data-type-label">
                                Type
                            </div>
                        </div>
                        <div class="horiz-line"></div>
                        <div class="mow-action" id="fert-action">
                            <i class="fa fa-sign-in"></i>&nbsp;&nbsp;Update</div>
                        <form role="form" id="fert-form">
                            <div class="form-update" id="fert-update">
                                <div class="horiz-form">
                                    <label>Date:</label>
                                    <input type="text" class="datepicker" id="fertLabel">
                                </div>
                                <div class="horiz-form">
                                    <label>Type:</label>
                                    <select id="new-fert-type" name="new-fert-type">
                                        <option value="" selected style="display:none;">Select...</option>
                                        <option value="Moss">Moss</option>
                                        <option value="Insecticide">Insecticide</option>
                                        <option value="Fall Feed">Fall Feed</option>
                                        <option value="W&F">W&amp;F</option>
                                        <option value="General">General</option>
                                    </select>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" id="cancel-fert-update">Cancel</button>
                                    <button type="button" class="btn btn-lawn" id="save-fert-update">Save changes</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!--conatiner-->
        </div>
    </div>
    <script>
        $('.datepicker').pickadate({
            format: 'mm/dd'
        })
    </script>
    <script>
        $(document).ready(function() {
            //hide update fields
            $('#mow-update').hide(0);
            $('#water-update').hide(0);
            $('#fert-update').hide(0);
            //show mow update on click
            $('#mow-action').click(function() {
                $('#mow-update').slideToggle(400);
            });
            //show water update on click
            $('#water-action').click(function() {
                $('#water-update').slideToggle(400);
            });
            //show fert update on click
            $('#fert-action').click(function() {
                $('#fert-update').slideToggle(400);
                $('html,body').animate({
                    scrollTop: $(document).height()
                }, 400);
            });
            //clear mow form on cancel
            $('#cancel-mow-update').click(function() {
                $('#mow-update').slideToggle(400);
                $('#mow-form')[0].reset();
            });
            //clear water form on cancel
            $('#cancel-water-update').click(function() {
                $('#water-update').slideToggle(400);
                $('#water-form')[0].reset();
            });
            //clear fert form on cancel
            $('#cancel-fert-update').click(function() {
                $('#fert-update').slideToggle(400);
                $('#fert-form')[0].reset();
            });
            //validate and update mow presentation on save
            $('#save-mow-update').click(function() {
                if ($('#new-mow-date').val().trim() === "" || $('#new-mow-direction').val() === "") {
                    alert('Enter data');
                } else {
                    lawn1 = new Lawn1();
                    lawn1.set("date", ($('#new-mow-date').val()));
                    lawn1.set("direction", ($('#new-mow-direction').val()));
                    lawn1.set("user", "Bryan");
                    lawn1.set("mode", "mow");
                    lawn1.save(null, {
                        success: function(lawn1) {
                            // Execute any logic that should take place after the object is saved.
                        },
                        error: function(lawn1, error) {
                            // Execute any logic that should take place if the save fails.
                            // error is a Parse.Error with an error code and description.
                        }
                    });
                    $('#mow-date-field1').text($('#new-mow-date').val());
                    $('#mow-direction1').text($('#new-mow-direction').val());
                    $('#mow-update').slideToggle(400);
                }
            });
            //validate and update water presentation on save
            $('#save-water-update').click(function() {
                if ($('#waterLabel').val().trim() === "") {
                    alert('Enter date');
                } else {
                    lawn1 = new Lawn1();
                    lawn1.set("date", ($('#waterLabel').val()));
                    lawn1.set("user", "Bryan");
                    lawn1.set("mode", "water");
                    lawn1.save(null, {
                        success: function(lawn1) {},
                        error: function(lawn1, error) {}
                    });
                    $('#water-date-field1').text($('#waterLabel').val());
                    $('#water-update').slideToggle(400);
                }
            });
            //validate and update fert presentation on save
            $('#save-fert-update').click(function() {
                if ($('#fertLabel').val().trim() === "" || $('#new-fert-type').val() === "") {
                    alert('Enter data');
                } else {
                    lawn1 = new Lawn1();
                    lawn1.set("date", ($('#fertLabel').val()));
                    lawn1.set("type", ($('#new-fert-type').val()));
                    lawn1.set("user", "Bryan");
                    lawn1.set("mode", "fert");
                    lawn1.save(null, {
                        success: function(lawn1) {},
                        error: function(lawn1, error) {}
                    });
                    $('#fert-date-field1').text($('#fertLabel').val());
                    $('#fert-type1').text($('#new-fert-type').val());
                    $('#fert-update').slideToggle(400);
                }
            });
        });
    </script>
    <script>
        var Lawn1 = Parse.Object.extend("Lawn1");
        var lawn1 = new Lawn1();
        var lawn1Query1 = new Parse.Query(Lawn1);
        var lawn1Query2 = new Parse.Query(Lawn1);
        var lawn1Query3 = new Parse.Query(Lawn1);
        /*var WaterUpdate1 = Parse.Object.extend("WaterUpdate1");
var waterUpdate1 = new WaterUpdate1();*/
        /*var waterQuery1 = new Parse.Query(WaterUpdate1);
var FertUpdate1 = Parse.Object.extend("FertUpdate1");
var fertUpdate1 = new FertUpdate1();
var fertQuery1 = new Parse.Query(FertUpdate1);*/

         //display saved data
        lawn1Query1.equalTo("mode", "mow");
        lawn1Query1.ascending('createdAt');
        lawn1Query1.find({
            success: function(results) {
                // Successfully retrieved the object.
                for (var i = 0; i < results.length; i++) {
                    var mowObject = results[results.length - 1];
                    //alert(object.id + ' - ' + object.get('date'));
                    //var results = object;
                    var lastMowDate = mowObject.get('date');
                    var lastDirection = mowObject.get('direction');
                    var lastMowCreated = mowObject.get('updatedAt');
                    $('#mow-date-field1').html(lastMowDate);
                    $('#mow-direction1').html(lastDirection);
                }
            },
            error: function(error) {
                alert("Error: " + error.code + " " + error.message);
            }
        });

         //display saved data
        lawn1Query2.equalTo("mode", "water");
        lawn1Query2.ascending('createdAt');
        lawn1Query2.find({
            success: function(results) {
                // Successfully retrieved the object.
                for (var i = 0; i < results.length; i++) {
                    var waterObject = results[results.length - 1];
                    var lastWaterDate = waterObject.get('date');
                    var lastWaterCreated = waterObject.get('updatedAt');
                    $('#water-date-field1').html(lastWaterDate);
                }
            },
            error: function(error) {
                alert("Error: " + error.code + " " + error.message);
            }
        });

         //display saved data
        lawn1Query3.equalTo("mode", "fert");
        lawn1Query3.ascending('createdAt');
        lawn1Query3.find({
            success: function(results) {
                // Successfully retrieved the object.
                for (var i = 0; i < results.length; i++) {
                    var fertObject = results[results.length - 1];
                    var lastFertDate = fertObject.get('date');
                    var lastType = fertObject.get('type');
                    var lastFertCreated = fertObject.get('updatedAt');
                    $('#fert-date-field1').html(lastFertDate);
                    $('#fert-type1').html(lastType);
                }
            },
            error: function(error) {
                alert("Error: " + error.code + " " + error.message);
            }
        });
    </script>
</body>

</html>